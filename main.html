<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Color Spread Grid 5x5</title>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700&display=swap"
      rel="stylesheet"
    />
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
      body {
        font-family: "Inter", sans-serif;
        touch-action: manipulation; /* Prevents double-tap zoom on mobile */
      }
      /* Custom styles for the grid and the fill effect */
      .grid-box {
        /* Smooth transition for the background color change */
        transition: background-color 0.2s ease-in-out;
        cursor: pointer;
        -webkit-tap-highlight-color: transparent; /* Removes tap highlight on mobile */
      }
      .grid-box.filled {
        background-color: #3b82f6; /* A nice blue color from Tailwind */
      }
    </style>
  </head>
  <body
    class="bg-slate-900 text-white flex flex-col items-center justify-center min-h-screen p-4"
  >
    <div class="text-center mb-8">
      <h1 class="text-3xl md:text-4xl font-bold mb-2">
        Color Spread Effect (5x5)
      </h1>
      <p class="text-slate-400">Click on any square to start the animation.</p>
    </div>

    <!-- Main container for the 5x5 grid -->
    <!-- Grid boxes will be added dynamically by JavaScript -->
    <div
      id="grid-container"
      class="grid grid-cols-5 grid-rows-5 gap-2 w-80 h-80 md:w-[500px] md:h-[500px] bg-slate-800 p-2 rounded-lg shadow-2xl"
    ></div>

    <!-- Reset button to allow re-running the animation -->
    <button
      id="reset-button"
      class="mt-8 px-6 py-3 bg-blue-600 text-white font-semibold rounded-lg shadow-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-400 focus:ring-opacity-75 transition-transform transform active:scale-95"
    >
      Reset
    </button>

    <script>
      document.addEventListener("DOMContentLoaded", () => {
        const gridContainer = document.getElementById("grid-container");
        const resetButton = document.getElementById("reset-button");
        const gridSize = 5;
        let gridBoxes = [];
        let isAnimating = false;

        /**
         * Calculates the Manhattan distance between every pair of cells in a grid.
         * The Manhattan distance is the sum of the absolute differences of their coordinates.
         * This creates the "spreading" effect from the clicked cell.
         * @param {number} size - The width and height of the grid.
         * @returns {Array<Array<number>>} A 2D array where distances[i] contains the distance from cell i to all other cells.
         */
        const generateDistances = (size) => {
          const totalBoxes = size * size;
          const distances = Array(totalBoxes)
            .fill(0)
            .map(() => Array(totalBoxes).fill(0));

          for (let i = 0; i < totalBoxes; i++) {
            for (let j = 0; j < totalBoxes; j++) {
              const r1 = Math.floor(i / size);
              const c1 = i % size;
              const r2 = Math.floor(j / size);
              const c2 = j % size;
              distances[i][j] = Math.abs(r1 - r2) + Math.abs(c1 - c2);
            }
          }
          return distances;
        };

        const distances = generateDistances(gridSize);

        /**
         * Dynamically creates the grid cells and adds them to the container.
         */
        const createGrid = () => {
          gridContainer.innerHTML = ""; // Clear any existing boxes
          for (let i = 0; i < gridSize * gridSize; i++) {
            const box = document.createElement("div");
            box.classList.add("grid-box", "bg-slate-700", "rounded-md");
            box.dataset.index = i;
            box.addEventListener("click", handleBoxClick);
            gridContainer.appendChild(box);
          }
          // Update the NodeList of grid boxes
          gridBoxes = document.querySelectorAll(".grid-box");
        };

        // Function to handle the click event on a grid box
        const handleBoxClick = (event) => {
          if (isAnimating) return;
          isAnimating = true;

          const clickedIndex = parseInt(event.target.dataset.index, 10);
          const distanceMap = distances[clickedIndex];
          const animationDelay = 300; // ms between each "ring" of the spread

          gridBoxes.forEach((box, index) => {
            const delay = distanceMap[index] * animationDelay;
            setTimeout(() => {
              box.classList.add("filled");
            }, delay);
          });

          // Set a timeout to reset the animation lock after it has completed
          const maxDistance = Math.max(...distanceMap);
          setTimeout(() => {
            isAnimating = false;
          }, maxDistance * animationDelay + 200);
        };

        // Function to reset the grid to its initial state
        const resetGrid = () => {
          if (isAnimating) return; // Don't reset during animation
          gridBoxes.forEach((box) => {
            box.classList.remove("filled");
          });
        };

        // Initial grid creation
        createGrid();

        // Add click event listener to the reset button
        resetButton.addEventListener("click", resetGrid);
      });
    </script>
  </body>
</html>
